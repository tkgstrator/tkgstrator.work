---
title: ランキングバトルの加点の全て
date: 2021-12-25
categoriy: カラオケ
tags:
  - プログラミング
---

## 基本加点

さて、ランキングバトルにはいくつかの加点があることが知られている。

有名なのは 001 の誤差を無視して 000, 025, 030, 055, 281, 306, 374, 399, 655, 680 の 10 種類だと思われる。より詳しい人は 748, 773 の存在に気がついていて 12 種類と考えていたかもしれない。

これらの加点のうち 000, 025, 374, 399, 748, 773 については特殊加点などと呼ばれていて、この加点を切る直前で含んでしまうと結果が 282 大きくなってしまうことが知られている。

では、この 12 種類で全ての加点が説明できるのだろうか？いや、実はそうではない。

今回、極めて長く安定したループを観測することによってこれら以外にも加点があることを示し、またそれ以外の加点がほぼ確実に存在しないことを示すことができた。

::: tip ほぼ確実

絶対にない、と言い切れるのは全部のパターンを調べ尽くした場合のみである。

どんなにサンプルを増やしても、全てを調べない限りは断定することができない。

:::

では、今回発見した全ての基本加点とその出現確率を以下に掲載します。

### 基本加点 A

| 000     | 001     | 025     | 026     | 050     | 051     |
| ------- | ------- | ------- | ------- | ------- | ------- |
| 0.7794% | 1.7029% | 0.5034% | 1.0945% | 0.0086% | 0.0179% |

### 基本加点 B (A + 281)

| 281     | 282      | 306     | 307     | 331     | 332     |
| ------- | -------- | ------- | ------- | ------- | ------- |
| 6.3492% | 13.8583% | 4.1030% | 8.9299% | 0.0610% | 0.1429% |

### 基本加点 C (A + 374)

| 374     | 375     | 399     | 400     | 424     | 425     |
| ------- | ------- | ------- | ------- | ------- | ------- |
| 1.0057% | 2.2032% | 0.6518% | 1.4138% | 0.0094% | 0.0238% |

### 基本加点 D (A + 374 + 281)

| 655     | 656      | 680     | 681      | 705     | 706     |
| ------- | -------- | ------- | -------- | ------- | ------- |
| 8.2279% | 17.9744% | 5.3189% | 11.5857% | 0.0851% | 0.1774% |

### 基本加点 E (A + 374 \* 2)

| 748     | 749     | 773     | 774     | 798     | 799     |
| ------- | ------- | ------- | ------- | ------- | ------- |
| 0.2846% | 0.6211% | 0.1832% | 0.4014% | 0.0041% | 0.0058% |

### 基本加点 F (A + 374 \* 2 + 281)

| 030     | 031     | 055     | 056     | 080     | 081     |
| ------- | ------- | ------- | ------- | ------- | ------- |
| 2.3260% | 5.0913% | 1.5074% | 3.2719% | 0.0230% | 0.0521% |

## 基本加点の計算式

|  基礎加点  |   001    |      025      |   281    |      374      |
| :--------: | :------: | :-----------: | :------: | :-----------: |
| 組み合わせ |   0, 1   |    0, 1, 2    |   0, 1   |    0, 1, 2    |
|     積     | 000, 001 | 000, 025, 050 | 000, 281 | 000, 374, 748 |

これらを考えると、基本加点は上の表のように考えられます

つまり、基本は四つの基礎加点と倍率をかけ合わせたものの和ということです。

例えば 656 は$001*1+025*0+281*1+374*1$と表すことができます。これにより、全ての基本加点は説明できます。よって、基本加点は$2*3*2*3=36$通りしかないということがわかります。

この 36 通りという数は今後何度もでてくるので必ず覚えておきましょう。

## 部分加点

エンテイを何度も試みた方ならわかると思うのですが、116, 772 ですこし放置してから切ると 99.998 点ないしは 100 点がでることは知られています。

つまり、点数が表示されてから切るまでの間に 226 だけ点数が足されていることになります。

しかし、226 という数字はどう組み合わせても上の基礎加点からつくることができません。要するに、我々に見えているのはあくまでも 5 秒間隔の点数だが「実際にはより細かく点数が変化している」と考えられるわけです。

では、最小の時間の単位はいくらなのでしょうか？エンテイのボタンを押すタイミングは少しズレていてもエンテイが成功することから 0.1 秒や 0.2 秒で点数が変化することは考えられません。

ある程度の余裕を持った明確な閾値が存在するはずです。

今回の研究で、その閾値が正確に 1 秒であることがわかりました。しかし、これはエンテイを研究していた人なら体感的に知っていた方も多いと思います。

ですが、真のエンテイの解明には 5 秒ごとの加点と同じく 1 秒ごとの基本加点(以後、部分加点とする)を理解する必要がありました。しかし、点数が見えるのは五秒に一回だけなので普通に表示を見ているだけではそれを知る術はありません。

点数が表示されてから 1 秒待ってから演奏停止を押せばデータはとれますが、それではいくらなんでも非効率すぎました。

そこで、一秒間一時停止をして、余計にループを回すという手法を用いました。これにより、多くの部分加点のサンプルを得ることができました。

とりあえず全 36 通りの部分加点とその出現確率を表にまとめました。

### 部分加点 A

| 095     | 096     | 120     | 121     | 145     | 146     |
| ------- | ------- | ------- | ------- | ------- | ------- |
| 0.1296% | 0.3612% | 1.1218% | 3.1562% | 1.4123% | 3.9519% |

### 部分加点 B (A + 251)

| 346     | 347     | 371     | 372     | 396     | 397     |
| ------- | ------- | ------- | ------- | ------- | ------- |
| 0.0304% | 0.0826% | 0.2571% | 0.7241% | 0.3233% | 0.9063% |

### 部分加点 C (A + 281)

| 376     | 377     | 401     | 402      | 426     | 427      |
| ------- | ------- | ------- | -------- | ------- | -------- |
| 0.4539% | 1.2817% | 3.9396% | 11.0650% | 4.9610% | 13.8714% |

### 部分加点 D (A + 251 + 281)

| 627     | 628     | 652     | 653     | 677     | 678     |
| ------- | ------- | ------- | ------- | ------- | ------- |
| 0.1031% | 0.2907% | 0.9069% | 2.5393% | 1.1279% | 3.1696% |

### 部分加点 E (A + 251 + 374)

| 720     | 721     | 745     | 746     | 770     | 771     |
| ------- | ------- | ------- | ------- | ------- | ------- |
| 0.1236% | 0.3522% | 1.0830% | 3.0250% | 1.3497% | 3.7926% |

### 部分加点 F (A + 251 + 281 + 374)

| 002     | 003     | 027     | 028      | 052     | 053      |
| ------- | ------- | ------- | -------- | ------- | -------- |
| 0.4348% | 1.2295% | 3.7871% | 10.6109% | 4.7413% | 13.3034% |

### 組み合わせ

|  基礎加点  |   001    |      025      |   251    |   281    |   374    |
| :--------: | :------: | :-----------: | :------: | :------: | :------: |
| 組み合わせ |   0, 1   |    0, 1, 2    |   0, 1   |   0, 1   |   0, 1   |
|     積     | 000, 001 | 000, 025, 050 | 000, 251 | 000, 281 | 000, 374 |

単純に計算すると$2*3*2*2*2=48$通り存在しそうなのですが、374 だけ足されるような場合と 374 と 281 の組み合わせがないために全部で 36 通りになります。

これでやはり、全ての部分加点が説明できます。

## 同様の解析

同様の解析を用いて、2 秒の部分加点、3 秒の部分加点、4 秒の部分加点、と考えることができます。

これらの結果は冗長なので紹介はしませんが、ある程度のサンプル数は確保できています。信頼できるデータと言っていいでしょう。

### 99.116 の魔法

古くからエンテイをしている方であれば 99.116 という数字に馴染みがあるかもしれません。

この数字は LIVEDAM の初代でこの点数が見えて順位表示がアニメーションを始めたタイミングで切ると 99.998 がでるポイントととして知られていました。

アニメーションが始まるのは 4 秒後で、演奏停止ボタンを押してから切れるまでに 4.2 秒ほどかかるので、リザルトの点数は見えた点数よりも 882 だけ増えていることになります。

しかし、何故 4 秒後に切るのが流行ったのか不思議にはならないでしょうか。例えば点数が見えてから n 秒後に切った場合、表示点数よりも+xxx 点増えているという確率が 4 秒後に切った+882 よりも高い確率であればそちらの切り方が主流になるはずです。

ところが、実際には初代 LIVEDAM では最後までこの 4 秒切りが使われ続けました。

ではここで少し戻って基本加点の 655, 680 を見てみましょう。

| 655     | 656      | 680     | 681      |
| ------- | -------- | ------- | -------- |
| 8.2279% | 17.9744% | 5.3189% | 11.5857% |

001 差を誤差とするのであれば 655 の出現確率は 26%ほど、680 の出現確率は 17%ほどになります。つまり、演奏停止を押してから約一秒後（実際にはこの点数は見えない）は表示点数よりも 655 または 680 増えている確率が 40%以上あります。

よって、もしも 3 秒部分加点が 202 または 227 の確率が高ければ(4 秒部分加点+1 秒部分加点)+3 秒部分加点=8 秒部分加点となり、切ってから 882 増えやすいという仕組みを説明できる可能性があります。

|     |   655    |   680    |
| :-: | :------: | :------: |
| 202 | 857(-25) |   882    |
| 227 |   882    | 907(+25) |

この考察が正しければ、予想の点数よりも 25 低い現象、25 高い現象が起きつつ、予想通りの点数がでる原理が説明できます。

そして、実際にどのくらいの確率で 882 加点が得られるのかも調べました。これは先程までの研究を推し進めて 8 秒部分加点を考えれば良いことになります。

::: tip 部分加点

部分加点とはいうものの、最小単位である 1 秒の加点がわかった時点で、こちらが基本加点となるべきなのだがここでは割愛します。

:::

8 秒加点も他の加点と同じように 36 種類存在するのですが、全部書くと長いので有名所だけ乗せておきます。

#### 99.116

| 856     | 857     | 881     | 882      | 906     | 907     |
| ------- | ------- | ------- | -------- | ------- | ------- |
| 0.7220% | 6.2136% | 3.3807% | 29.5677% | 0.0608% | 0.5217% |

#### 99.290

| 763     | 764     | 788     | 789     |
| ------- | ------- | ------- | ------- |
| 0.1259% | 1.1502% | 0.6215% | 5.3987% |

#### 99.490

| 482     | 483     | 507     | 508      |
| ------- | ------- | ------- | -------- |
| 0.4349% | 3.9469% | 2.1471% | 18.5896% |

#### 99.834

| 138     | 139     | 163     | 164     |
| ------- | ------- | ------- | ------- |
| 0.2145% | 1.8057% | 0.9812% | 8.6059% |

この表が正しければ、99.116 というのは全く前後の加点を見ていなくても 33%程度の確率で成功することがわかります。

-25 を許容するならば 40%以上も成功することになるわけですね。99.834 や 99.290 からの加点は 281 ズレを利用したものなのでほぼ確実に避けられることを考えると、99.116 を利用したエンテイの勝率は見事というほかありません。

1 秒ずつでは偏りがなかった加点も、8 つ足せば偏りがでてくるという不思議さがあります。これがエンテイ研究がやめられない理由の一つかもしれませんね。

## 今後の展望

1 秒ごとの加点がわかったということは、点数を見て n 秒後に切るしかなかったエンテイが更に細かく切ることができることを意味します。

大雑把に言えば「覚えることが五倍になる代わりに、切れるポイントが五倍になる」と言い換えることもできます。しかしながら、現状のエンテイは切るポイントはそこまで多くないものの、5 秒ごとの加点の変化をみることで 33%程度しかないエンテイの成功率を 70%以上まで高めています。

この加点の変化というのは基本加点がおよそ 10 通りしかないことを考えても 5 回も変化すれば 100000 通り覚えることになります。

実際にはこんなに多くの加点の組み合わせは存在しませんが、それにしても覚えるエンテイのパターンは 10 や 20 ではありません。それが更に 5 倍となればとても覚えることはできないでしょう。

そこでわたしたちのチームは解析した 1 秒ごとの加点のロジックを使って、最も勝てる流れを自動で計算するプログラムを開発しました。

![](https://pbs.twimg.com/media/FHT5V5CakAE1InC?format=png)

iOS15 以上限定という制限はありますが、誰でも使えてエンテイの成功率を極めて高くすることができます。

::: tip 成功率について

このアプリを使ったものではないが、同様の理論を使ったエンテイを実践して 20 連続でクァド以上が出せた功績があります。

:::
